---
layout: post
title:  "Resizing the InnoDB System Tablespace"
date:   2016-01-21 12:00:00
categories: innoDB-tablespace-management
---

This section describes how to increase or decrease the size of the InnoDB system tablespace. 

### Increasing the Size of the InnoDB System Tablespace

The easiest way to increase the size of the InnoDB system tablespace is to configure it from the beginning to be auto-extending. Specify the autoextend attribute for the last data file in the tablespace definition. Then InnoDB increases the size of that file automatically in 8MB increments when it runs out of space. The increment size can be changed by setting the value of the innodb_autoextend_increment system variable, which is measured in megabytes. 

You can expand the system tablespace by a defined amount by adding another data file: 

- Shut down the MySQL server.

- If the previous last data file is defined with the keyword autoextend, change its definition to use a fixed size, based on how large it has actually grown. Check the size of the data file, round it down to the closest multiple of 1024 Ã— 1024 bytes (= 1MB), and specify this rounded size explicitly in innodb_data_file_path.

- Add a new data file to the end of innodb_data_file_path, optionally making that file auto-extending. Only the last data file in the innodb_data_file_path can be specified as auto-extending.

- Start the MySQL server again. 

For example, this tablespace has just one auto-extending data file ibdata1: 

{% highlight java %}
innodb_data_home_dir =
innodb_data_file_path = /ibdata/ibdata1:10M:autoextend
{% endhighlight %}

Suppose that this data file, over time, has grown to 988MB. Here is the configuration line after modifying the original data file to use a fixed size and adding a new auto-extending data file: 

{% highlight java %}
innodb_data_home_dir =
innodb_data_file_path = /ibdata/ibdata1:988M;/disk2/ibdata2:50M:autoextend
{% endhighlight %}

When you add a new data file to the system tablespace configuration, make sure that the filename does not refer to an existing file. InnoDB creates and initializes the file when you restart the server. 

### Decreasing the Size of the InnoDB System Tablespace

You cannot remove a data file from the system tablespace. To decrease the system tablespace size, use this procedure: 

- Use mysqldump to dump all your InnoDB tables, including InnoDB tables located in the MySQL database. As of 5.6, there are five InnoDB tables included in the MySQL database: 

{% highlight java %}
mysql> select table_name from information_schema.tables where table_schema='mysql' and engine='InnoDB';
+----------------------+
| table_name           |
+----------------------+
| innodb_index_stats   |
| innodb_table_stats   |
| slave_master_info    |
| slave_relay_log_info |
| slave_worker_info    |
+----------------------+
5 rows in set (0.00 sec)
{% endhighlight %}

- Stop the server.

- Remove all the existing tablespace files (*.ibd), including the ibdata and ib_log files. Do not forget to remove *.ibd files for tables located in the MySQL database.

- Remove any .frm files for InnoDB tables.

- Configure a new tablespace.

- Restart the server.

- Import the dump files. 

> Note
> 
> If your databases only use the InnoDB engine, it may be simpler to dump all databases, stop the server, remove all databases and InnoDB log files, restart the server, and import the dump files.
